# Django API with Python    
credit to: https://www.pyimagesearch.com/2015/05/11/creating-a-face-detection-api-with-python-and-opencv-in-just-5-minutes/   

***  
Creating a face detection API with Python and OpenCV (in just 5 minutes)   
***   
 
# Step 1: Setup your environment    
$ pip install numpy django requests   

# Step 2: Create our Django project   
$ django-admin startproject cv_api    
$ cd cv_api     
A Django project consists of multiple apps. And one of the core paradigms of the Django framework is that each app should be reusable in any project (theoretically, anyway) — therefore, we do not (normally) place any app-specific code inside the cv_api  directory. Instead, we explicitly create separate “apps” inside the cv_api  project.    

$ python manage.py startapp face_detector     
When you install django using just pip install django, then you have to run python manage.py startapp else if you used pip3Click here to view terminal example install django, then you have to run python3 manage.py startapp      

Now that our Django project is all setup, we can get to coding.    

# Step 3: My personal computer vision API template   
The Django framework is a type of a Model-View-Template (MVT) framework, similar to a Model-View-Controller, where a “View” can be thought of as a type of web page.    

# Step 4: Inserting the face detector into my template API   
copy and paste the haarcascades package in data package of opencv in face_detector, rename cascades (will use haarcascade_frontalface_default.xml)   

# Step 5: Update the URLs to include an endpoint to our API   
Follow the idea here: https://docs.djangoproject.com/en/2.0/intro/tutorial01/   

change 1   
As of Django 1.10, the patterns module has been removed (it had been deprecated since 1.8).    
urls.py in cv_api of cv_api:   
from django.urls import include,path   
from django.contrib import admin   
urlpatterns = [
    # Examples:
 
    path('face_detector/', include('face_detector.urls')),
    path('admin/', admin.site.urls),

    #url(r'^face_detection/detect/$', face_detector.views.detect),
    #url(r'^admin/', admin.site.urls),
]     

change 2   
in face_detector of cv_api:
add file called urls.py   
from django.urls import path   
from . import views   
urlpatterns = [

    path('', views.detect, name='detect'),  
]    


Final files:    
cv_api   
  -- cv_api   
    -- __pycache__   
    -- __init__.py   
    -- settings.py   
    -- urls.py   
    -- wsgi.py   
  -- face_detector  
    -- cascades  
    -- migrations  
    -- __pycache__  
    -- admin.py  
    -- apps.py  
    -- __init__.py   
    -- models.py  
    -- tests.py  
    -- urls.py  
    -- views.py  
 -- manage.py  
 -- db.sqlite3   

# Step 6: Run the Django test server   
When you install django using just pip install django, then you have to run python manage.py startapp else if you used pip3Click here to view terminal example install django, then you have to run python3 manage.py startapp      
http://localhost:8000/face_detector/   

# Step 7: Test out the face detection API via cURL    
error 1 occured: Forbidden (CSRF cookie not set.)    
add # before 'django.middleware.csrf.CsrfViewMiddleware', in settings.py in cv-api/cv-api    

error 2 occured: Debug need to be false, and Django will display a standard page generated by the handler for this status code.            
When DEBUG is True and ALLOWED_HOSTS is empty, the host is validated against ['localhost', '127.0.0.1', '[::1]'].   
DEBUG = False   
ALLOWED_HOSTS = ['*']   
follow idea here: https://stackoverflow.com/questions/24857158/commanderror-you-must-set-settings-allowed-hosts-if-debug-is-false   
https://docs.djangoproject.com/en/1.9/ref/settings/#allowed-hosts   

error 3 occured: Server Error (500)      








# Another demo   
https://docs.djangoproject.com/en/2.0/intro/tutorial01/    
